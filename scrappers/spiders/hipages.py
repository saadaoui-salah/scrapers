import scrapy
from scrapy import Request
from scrappers.items import Service
import json
from html import unescape
from w3lib.html import remove_tags


LOCATIONS = [{'id': 107, 'postcode': '850', 'suburb': 'Katherine', 'suburb_seo_key': 'katherine_850', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'katherine', 'region_key_old': None, 'region_name': 'Katherine', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 11.796142, 'matched_on': 'postcode'}, {'id': 104, 'postcode': '845', 'suburb': 'Batchelor', 'suburb_seo_key': 'batchelor', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_darwin', 'region_key_old': None, 'region_name': 'South Darwin', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 105, 'postcode': '846', 'suburb': 'Adelaide River', 'suburb_seo_key': 'adelaide_river', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'darwin', 'region_key_old': None, 'region_name': 'Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 106, 'postcode': '847', 'suburb': 'Pine Creek', 'suburb_seo_key': 'pine_creek', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'katherine', 'region_key_old': None, 'region_name': 'Katherine', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 128, 'postcode': '860', 'suburb': 'Tennant Creek', 'suburb_seo_key': 'tennant_creek', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'alice_springs', 'region_key_old': None, 'region_name': 'Alice Springs', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 200, 'postcode': '885', 'suburb': 'Alyangula', 'suburb_seo_key': 'alyangula', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'top_end', 'region_key_old': None, 'region_name': 'Top End Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 201, 'postcode': '886', 'suburb': 'Jabiru', 'suburb_seo_key': 'jabiru', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'top_end', 'region_key_old': None, 'region_name': 'Top End Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 15369, 'postcode': '841', 'suburb': 'Darwin River', 'suburb_seo_key': 'darwin_river', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_darwin', 'region_key_old': None, 'region_name': 'South Darwin', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 15524, 'postcode': '838', 'suburb': 'Berry Springs', 'suburb_seo_key': 'berry_springs', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_darwin', 'region_key_old': None, 'region_name': 'South Darwin', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 15661, 'postcode': '834', 'suburb': 'Virginia', 'suburb_seo_key': 'virginia', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'darwin', 'region_key_old': None, 'region_name': 'Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 15663, 'postcode': '839', 'suburb': 'Coolalinga', 'suburb_seo_key': 'coolalinga', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'darwin', 'region_key_old': None, 'region_name': 'Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 15710, 'postcode': '853', 'suburb': 'Tindal', 'suburb_seo_key': 'tindal', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'katherine', 'region_key_old': None, 'region_name': 'Katherine', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 15777, 'postcode': '873', 'suburb': 'Kilgariff', 'suburb_seo_key': 'kilgariff', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'alice_springs', 'region_key_old': None, 'region_name': 'Alice Springs', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 1, 'postcode': '800', 'suburb': 'Darwin', 'suburb_seo_key': 'darwin', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'darwin', 'region_key_old': None, 'region_name': 'Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 79, 'postcode': '828', 'suburb': 'Berrimah', 'suburb_seo_key': 'berrimah', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'east_darwin', 'region_key_old': None, 'region_name': 'East Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 80, 'postcode': '828', 'suburb': 'Knuckey Lagoon', 'suburb_seo_key': 'knuckey_lagoon', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'east_darwin', 'region_key_old': None, 'region_name': 'East Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 98, 'postcode': '835', 'suburb': 'Howard Springs', 'suburb_seo_key': 'howard_springs', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_east_darwin', 'region_key_old': None, 'region_name': 'North East Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 99, 'postcode': '835', 'suburb': 'Virginia', 'suburb_seo_key': 'virginia_835', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_east_darwin', 'region_key_old': None, 'region_name': 'North East Darwin Region', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 102, 'postcode': '837', 'suburb': 'Manton', 'suburb_seo_key': 'manton', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_east_darwin', 'region_key_old': None, 'region_name': 'South East Darwin', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 103, 'postcode': '837', 'suburb': 'Noonamah', 'suburb_seo_key': 'noonamah', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_east_darwin', 'region_key_old': None, 'region_name': 'South East Darwin', 'state_id': 3, 'state_name': 'Northern Territory', 'state_key': 'nt', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 14609, 'postcode': '7025', 'suburb': 'Richmond', 'suburb_seo_key': 'richmond', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 13.229408, 'matched_on': 'postcode'}, {'id': 14647, 'postcode': '7050', 'suburb': 'Kingston', 'suburb_seo_key': 'kingston', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 13.229408, 'matched_on': 'postcode'}, {'id': 14812, 'postcode': '7171', 'suburb': 'Midway Point', 'suburb_seo_key': 'midway_point', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 13.229408, 'matched_on': 'postcode'}, {'id': 14808, 'postcode': '7170', 'suburb': 'Cambridge', 'suburb_seo_key': 'cambridge', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 12.046723, 'matched_on': 'postcode'}, {'id': 14825, 'postcode': '7173', 'suburb': 'Primrose Sands', 'suburb_seo_key': 'primrose_sands', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'southern_region_tas', 'region_key_old': None, 'region_name': 'Southern Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 11.581491, 'matched_on': 'postcode'}, {'id': 14722, 'postcode': '7120', 'suburb': 'Oatlands', 'suburb_seo_key': 'oatlands', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'eastern_region_tas', 'region_key_old': None, 'region_name': 'Eastern Region (eg. Derby)', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 10.148224, 'matched_on': 'postcode'}, {'id': 14676, 'postcode': '7109', 'suburb': 'Huonville', 'suburb_seo_key': 'huonville', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'southern_region_tas', 'region_key_old': None, 'region_name': 'Southern Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.578989, 'matched_on': 'postcode'}, {'id': 14584, 'postcode': '7016', 'suburb': 'Risdon Vale', 'suburb_seo_key': 'risdon_vale', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14604, 'postcode': '7021', 'suburb': 'Lauderdale', 'suburb_seo_key': 'lauderdale', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14605, 'postcode': '7022', 'suburb': 'South Arm', 'suburb_seo_key': 'south_arm', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14606, 'postcode': '7023', 'suburb': 'Opossum Bay', 'suburb_seo_key': 'opossum_bay', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14607, 'postcode': '7024', 'suburb': 'Cremorne', 'suburb_seo_key': 'cremorne', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14610, 'postcode': '7026', 'suburb': 'Campania', 'suburb_seo_key': 'campania', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14611, 'postcode': '7027', 'suburb': 'Colebrook', 'suburb_seo_key': 'colebrook', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'central_region_tas', 'region_key_old': None, 'region_name': 'Central Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14649, 'postcode': '7052', 'suburb': 'Blackmans Bay', 'suburb_seo_key': 'blackmans_bay', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14667, 'postcode': '7055', 'suburb': 'Huntingfield', 'suburb_seo_key': 'huntingfield', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'hobart', 'region_key_old': None, 'region_name': 'Hobart Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14706, 'postcode': '7113', 'suburb': 'Franklin', 'suburb_seo_key': 'franklin', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'southern_region_tas', 'region_key_old': None, 'region_name': 'Southern Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14715, 'postcode': '7117', 'suburb': 'Dover', 'suburb_seo_key': 'dover', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'southern_region_tas', 'region_key_old': None, 'region_name': 'Southern Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 14802, 'postcode': '7155', 'suburb': 'Kettering', 'suburb_seo_key': 'kettering', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'southern_region_tas', 'region_key_old': None, 'region_name': 'Southern Region', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 17984, 'postcode': '7119', 'suburb': 'Stonor', 'suburb_seo_key': 'stonor', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'eastern_region_tas', 'region_key_old': None, 'region_name': 'Eastern Region (eg. Derby)', 'state_id': 6, 'state_name': 'Tasmania', 'state_key': 'tas', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 12931, 'postcode': '6000', 'suburb': 'Perth', 'suburb_seo_key': 'perth', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth', 'region_key_old': None, 'region_name': 'Perth City Region', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 12935, 'postcode': '6004', 'suburb': 'East Perth', 'suburb_seo_key': 'east_perth', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth', 'region_key_old': None, 'region_name': 'Perth City Region', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 12938, 'postcode': '6006', 'suburb': 'North Perth', 'suburb_seo_key': 'north_perth', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 12956, 'postcode': '6012', 'suburb': 'Mosman Park', 'suburb_seo_key': 'mosman_park', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_western_suburbs', 'region_key_old': None, 'region_name': 'Perth Western Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 12961, 'postcode': '6015', 'suburb': 'City Beach', 'suburb_seo_key': 'city_beach', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_western_suburbs', 'region_key_old': None, 'region_name': 'Perth Western Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 12981, 'postcode': '6022', 'suburb': 'Hamersley', 'suburb_seo_key': 'hamersley', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_inner_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Inner Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13003, 'postcode': '6029', 'suburb': 'Trigg', 'suburb_seo_key': 'trigg', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13013, 'postcode': '6032', 'suburb': 'Nowergup', 'suburb_seo_key': 'nowergup', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13014, 'postcode': '6033', 'suburb': 'Carabooda', 'suburb_seo_key': 'carabooda', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13015, 'postcode': '6034', 'suburb': 'Eglinton', 'suburb_seo_key': 'eglinton', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13016, 'postcode': '6035', 'suburb': 'Yanchep', 'suburb_seo_key': 'yanchep', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13017, 'postcode': '6037', 'suburb': 'Two Rocks', 'suburb_seo_key': 'two_rocks', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13023, 'postcode': '6042', 'suburb': 'Seabird', 'suburb_seo_key': 'seabird', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'mid_west', 'region_key_old': None, 'region_name': 'Mid West', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13033, 'postcode': '6051', 'suburb': 'Maylands', 'suburb_seo_key': 'maylands', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_eastern_suburbs', 'region_key_old': None, 'region_name': 'Perth Eastern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13036, 'postcode': '6053', 'suburb': 'Bayswater', 'suburb_seo_key': 'bayswater', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_eastern_suburbs', 'region_key_old': None, 'region_name': 'Perth Eastern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13067, 'postcode': '6058', 'suburb': 'Forrestfield', 'suburb_seo_key': 'forrestfield', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_eastern_suburbs', 'region_key_old': None, 'region_name': 'Perth Eastern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 13068, 'postcode': '6059', 'suburb': 'Dianella', 'suburb_seo_key': 'dianella', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_inner_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Inner Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 15404, 'postcode': '6038', 'suburb': 'Alkimos', 'suburb_seo_key': 'alkimos', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth_northern_suburbs', 'region_key_old': None, 'region_name': 'Perth Northern Suburbs', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 12933, 'postcode': '6003', 'suburb': 'Highgate', 'suburb_seo_key': 'highgate', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth', 'region_key_old': None, 'region_name': 'Perth City Region', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 12934, 'postcode': '6003', 'suburb': 'Northbridge', 'suburb_seo_key': 'northbridge', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'perth', 'region_key_old': None, 'region_name': 'Perth City Region', 'state_id': 8, 'state_name': 'Western Australia', 'state_key': 'wa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11400, 'postcode': '5006', 'suburb': 'North Adelaide', 'suburb_seo_key': 'north_adelaide', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'adelaide', 'region_key_old': None, 'region_name': 'Adelaide Region', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 11456, 'postcode': '5020', 'suburb': 'West Lakes Shore', 'suburb_seo_key': 'west_lakes_shore', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 11457, 'postcode': '5021', 'suburb': 'West Lakes', 'suburb_seo_key': 'west_lakes', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 11507, 'postcode': '5040', 'suburb': 'Novar Gardens', 'suburb_seo_key': 'novar_gardens', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 17236, 'postcode': '5005', 'suburb': 'Adelaide University', 'suburb_seo_key': 'adelaide_university', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'adelaide', 'region_key_old': None, 'region_name': 'Adelaide Region', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 11392, 'postcode': '5000', 'suburb': 'Adelaide', 'suburb_seo_key': 'adelaide', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'adelaide', 'region_key_old': None, 'region_name': 'Adelaide Region', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11396, 'postcode': '5000', 'suburb': 'Parliament House', 'suburb_seo_key': 'parliament_house', 'popular_suburb': 'N', 'no_backlinks': 1, 'robots_noindex': 1, 'region_key': 'adelaide', 'region_key_old': None, 'region_name': 'Adelaide Region', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11448, 'postcode': '5017', 'suburb': 'Osborne', 'suburb_seo_key': 'osborne', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11449, 'postcode': '5017', 'suburb': 'Taperoo', 'suburb_seo_key': 'taperoo', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11450, 'postcode': '5018', 'suburb': 'North Haven', 'suburb_seo_key': 'north_haven', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11451, 'postcode': '5018', 'suburb': 'Outer Harbor', 'suburb_seo_key': 'outer_harbor', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11469, 'postcode': '5025', 'suburb': 'Flinders Park', 'suburb_seo_key': 'flinders_park', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'adelaide', 'region_key_old': None, 'region_name': 'Adelaide Region', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11470, 'postcode': '5025', 'suburb': 'Kidman Park', 'suburb_seo_key': 'kidman_park', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'adelaide', 'region_key_old': None, 'region_name': 'Adelaide Region', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11523, 'postcode': '5044', 'suburb': 'Glengowrie', 'suburb_seo_key': 'glengowrie', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11524, 'postcode': '5044', 'suburb': 'Somerton Park', 'suburb_seo_key': 'somerton_park', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11530, 'postcode': '5046', 'suburb': 'Oaklands Park', 'suburb_seo_key': 'oaklands_park', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11531, 'postcode': '5046', 'suburb': 'Warradale', 'suburb_seo_key': 'warradale', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_beachside_suburbs', 'region_key_old': None, 'region_name': 'Western & Beachside Suburbs', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11547, 'postcode': '5050', 'suburb': 'Bellevue Heights', 'suburb_seo_key': 'bellevue_heights', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_south_east', 'region_key_old': None, 'region_name': 'South East', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11548, 'postcode': '5050', 'suburb': 'Eden Hills', 'suburb_seo_key': 'eden_hills', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_south_east', 'region_key_old': None, 'region_name': 'South East', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 11553, 'postcode': '5052', 'suburb': 'Belair', 'suburb_seo_key': 'belair', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_south_east', 'region_key_old': None, 'region_name': 'South East', 'state_id': 5, 'state_name': 'South Australia', 'state_key': 'sa', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8116, 'postcode': '4054', 'suburb': 'Keperra', 'suburb_seo_key': 'keperra', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_suburbs', 'region_key_old': None, 'region_name': 'North West Suburbs Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 12.724701, 'matched_on': 'postcode'}, {'id': 8117, 'postcode': '4055', 'suburb': 'Bunya', 'suburb_seo_key': 'bunya', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_suburbs', 'region_key_old': None, 'region_name': 'North West Suburbs Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 12.046723, 'matched_on': 'postcode'}, {'id': 8118, 'postcode': '4055', 'suburb': 'Ferny Grove', 'suburb_seo_key': 'ferny_grove', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_suburbs', 'region_key_old': None, 'region_name': 'North West Suburbs Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 12.046723, 'matched_on': 'postcode'}, {'id': 8119, 'postcode': '4055', 'suburb': 'Ferny Hills', 'suburb_seo_key': 'ferny_hills', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_suburbs', 'region_key_old': None, 'region_name': 'North West Suburbs Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 12.046723, 'matched_on': 'postcode'}, {'id': 8032, 'postcode': '4009', 'suburb': 'Eagle Farm', 'suburb_seo_key': 'eagle_farm', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane', 'region_key_old': None, 'region_name': 'Brisbane Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 8042, 'postcode': '4013', 'suburb': 'Northgate', 'suburb_seo_key': 'northgate', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'northern_suburbs', 'region_key_old': None, 'region_name': 'Brisbane Northern Suburbs', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 8068, 'postcode': '4022', 'suburb': 'Rothwell', 'suburb_seo_key': 'rothwell', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'redcliffe_bribie_caboolture', 'region_key_old': None, 'region_name': 'Redcliffe, Bribie & Caboolture Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 8095, 'postcode': '4036', 'suburb': 'Bald Hills', 'suburb_seo_key': 'bald_hills', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'northern_suburbs', 'region_key_old': None, 'region_name': 'Brisbane Northern Suburbs', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 8096, 'postcode': '4037', 'suburb': 'Eatons Hill', 'suburb_seo_key': 'eatons_hill', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'northern_suburbs', 'region_key_old': None, 'region_name': 'Brisbane Northern Suburbs', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 8131, 'postcode': '4061', 'suburb': 'The Gap', 'suburb_seo_key': 'the_gap_4061', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_suburbs', 'region_key_old': None, 'region_name': 'North West Suburbs Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 8015, 'postcode': '4005', 'suburb': 'New Farm', 'suburb_seo_key': 'new_farm', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane', 'region_key_old': None, 'region_name': 'Brisbane Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8033, 'postcode': '4010', 'suburb': 'Albion', 'suburb_seo_key': 'albion', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane', 'region_key_old': None, 'region_name': 'Brisbane Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8034, 'postcode': '4010', 'suburb': 'Breakfast Creek', 'suburb_seo_key': 'breakfast_creek', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane', 'region_key_old': None, 'region_name': 'Brisbane Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8055, 'postcode': '4018', 'suburb': 'Fitzgibbon', 'suburb_seo_key': 'fitzgibbon', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'northern_suburbs', 'region_key_old': None, 'region_name': 'Brisbane Northern Suburbs', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8056, 'postcode': '4018', 'suburb': 'Taigum', 'suburb_seo_key': 'taigum', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'northern_suburbs', 'region_key_old': None, 'region_name': 'Brisbane Northern Suburbs', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8067, 'postcode': '4021', 'suburb': 'Kippa-Ring', 'suburb_seo_key': 'kippa-ring', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'redcliffe_bribie_caboolture', 'region_key_old': None, 'region_name': 'Redcliffe, Bribie & Caboolture Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8145, 'postcode': '4067', 'suburb': 'Ironside', 'suburb_seo_key': 'ironside', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane_south', 'region_key_old': None, 'region_name': 'Brisbane South Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8146, 'postcode': '4067', 'suburb': 'St Lucia', 'suburb_seo_key': 'st_lucia', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane_south', 'region_key_old': None, 'region_name': 'Brisbane South Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8167, 'postcode': '4073', 'suburb': 'Seventeen Mile Rocks', 'suburb_seo_key': 'seventeen_mile_rocks', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane_south', 'region_key_old': None, 'region_name': 'Brisbane South Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 8168, 'postcode': '4073', 'suburb': 'Sinnamon Park', 'suburb_seo_key': 'sinnamon_park', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'brisbane_south', 'region_key_old': None, 'region_name': 'Brisbane South Region', 'state_id': 4, 'state_name': 'Queensland', 'state_key': 'qld', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 4970, 'postcode': '3030', 'suburb': 'Cocoroc', 'suburb_seo_key': 'cocoroc', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 11.581491, 'matched_on': 'postcode'}, {'id': 4971, 'postcode': '3030', 'suburb': 'Derrimut', 'suburb_seo_key': 'derrimut', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 11.581491, 'matched_on': 'postcode'}, {'id': 4972, 'postcode': '3030', 'suburb': 'Point Cook', 'suburb_seo_key': 'point_cook', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 11.581491, 'matched_on': 'postcode'}, {'id': 4973, 'postcode': '3030', 'suburb': 'Quandong', 'suburb_seo_key': 'quandong', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 11.581491, 'matched_on': 'postcode'}, {'id': 4974, 'postcode': '3030', 'suburb': 'Werribee', 'suburb_seo_key': 'werribee', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 11.581491, 'matched_on': 'postcode'}, {'id': 4975, 'postcode': '3030', 'suburb': 'Werribee South', 'suburb_seo_key': 'werribee_south', 'popular_suburb': 'Y', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 11.581491, 'matched_on': 'postcode'}, {'id': 4912, 'postcode': '3000', 'suburb': 'Melbourne', 'suburb_seo_key': 'melbourne', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'melbourne_cbd', 'region_key_old': 'Melbourne_City', 'region_name': 'Melbourne CBD Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4913, 'postcode': '3002', 'suburb': 'East Melbourne', 'suburb_seo_key': 'east_melbourne', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'melbourne_cbd', 'region_key_old': 'Melbourne_City', 'region_name': 'Melbourne CBD Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4914, 'postcode': '3003', 'suburb': 'West Melbourne', 'suburb_seo_key': 'west_melbourne', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'melbourne_cbd', 'region_key_old': 'Melbourne_City', 'region_name': 'Melbourne CBD Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4927, 'postcode': '3013', 'suburb': 'Yarraville', 'suburb_seo_key': 'yarraville', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4948, 'postcode': '3022', 'suburb': 'Ardeer', 'suburb_seo_key': 'ardeer', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_melbourne', 'region_key_old': None, 'region_name': 'North West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4961, 'postcode': '3025', 'suburb': 'Altona North', 'suburb_seo_key': 'altona_north', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4962, 'postcode': '3026', 'suburb': 'Laverton North', 'suburb_seo_key': 'laverton_north', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'west_melbourne', 'region_key_old': 'Melbourne_West', 'region_name': 'West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4982, 'postcode': '3033', 'suburb': 'Keilor East', 'suburb_seo_key': 'keilor_east', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_melbourne', 'region_key_old': None, 'region_name': 'North West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4983, 'postcode': '3034', 'suburb': 'Avondale Heights', 'suburb_seo_key': 'avondale_heights', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_melbourne', 'region_key_old': None, 'region_name': 'North West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 4996, 'postcode': '3039', 'suburb': 'Moonee Ponds', 'suburb_seo_key': 'moonee_ponds', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_melbourne', 'region_key_old': None, 'region_name': 'North Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 5022, 'postcode': '3051', 'suburb': 'North Melbourne', 'suburb_seo_key': 'north_melbourne', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'melbourne_cbd', 'region_key_old': 'Melbourne_City', 'region_name': 'Melbourne CBD Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 5024, 'postcode': '3052', 'suburb': 'Parkville', 'suburb_seo_key': 'parkville', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'melbourne_cbd', 'region_key_old': 'Melbourne_City', 'region_name': 'Melbourne CBD Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 5025, 'postcode': '3053', 'suburb': 'Carlton', 'suburb_seo_key': 'carlton', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'melbourne_cbd', 'region_key_old': 'Melbourne_City', 'region_name': 'Melbourne CBD Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 5030, 'postcode': '3055', 'suburb': 'Brunswick West', 'suburb_seo_key': 'brunswick_west', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_west_melbourne', 'region_key_old': None, 'region_name': 'North West Melbourne Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 212, 'postcode': '2007', 'suburb': 'Ultimo', 'suburb_seo_key': 'ultimo', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_cbd', 'region_key_old': 'Sydney_City', 'region_name': 'Sydney CBD Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 230, 'postcode': '2016', 'suburb': 'Redfern', 'suburb_seo_key': 'redfern', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_sydney', 'region_key_old': 'Sydney_South', 'region_name': 'South Sydney Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 237, 'postcode': '2020', 'suburb': 'Mascot', 'suburb_seo_key': 'mascot', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_sydney', 'region_key_old': 'Sydney_South', 'region_name': 'South Sydney Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 244, 'postcode': '2023', 'suburb': 'Bellevue Hill', 'suburb_seo_key': 'bellevue_hill', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_eastern_suburbs', 'region_key_old': 'Sydney_East', 'region_name': 'Sydney Eastern Suburbs', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 248, 'postcode': '2025', 'suburb': 'Woollahra', 'suburb_seo_key': 'woollahra', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_eastern_suburbs', 'region_key_old': 'Sydney_East', 'region_name': 'Sydney Eastern Suburbs', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 258, 'postcode': '2028', 'suburb': 'Double Bay', 'suburb_seo_key': 'double_bay', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_eastern_suburbs', 'region_key_old': 'Sydney_East', 'region_name': 'Sydney Eastern Suburbs', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 259, 'postcode': '2029', 'suburb': 'Rose Bay', 'suburb_seo_key': 'rose_bay', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_eastern_suburbs', 'region_key_old': 'Sydney_East', 'region_name': 'Sydney Eastern Suburbs', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 272, 'postcode': '2033', 'suburb': 'Kensington', 'suburb_seo_key': 'kensington', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'south_sydney', 'region_key_old': 'Sydney_South', 'region_name': 'South Sydney Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 289, 'postcode': '2038', 'suburb': 'Annandale', 'suburb_seo_key': 'annandale', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_inner_west', 'region_key_old': None, 'region_name': 'Sydney Inner West', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 290, 'postcode': '2039', 'suburb': 'Rozelle', 'suburb_seo_key': 'rozelle', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_inner_west', 'region_key_old': None, 'region_name': 'Sydney Inner West', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 297, 'postcode': '2042', 'suburb': 'Newtown', 'suburb_seo_key': 'newtown', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_inner_west', 'region_key_old': None, 'region_name': 'Sydney Inner West', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 298, 'postcode': '2043', 'suburb': 'Erskineville', 'suburb_seo_key': 'erskineville', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_cbd', 'region_key_old': 'Sydney_City', 'region_name': 'Sydney CBD Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 302, 'postcode': '2045', 'suburb': 'Haberfield', 'suburb_seo_key': 'haberfield', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_inner_west', 'region_key_old': None, 'region_name': 'Sydney Inner West', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 310, 'postcode': '2047', 'suburb': 'Drummoyne', 'suburb_seo_key': 'drummoyne', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_inner_west', 'region_key_old': None, 'region_name': 'Sydney Inner West', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 311, 'postcode': '2048', 'suburb': 'Stanmore', 'suburb_seo_key': 'stanmore', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_inner_west', 'region_key_old': None, 'region_name': 'Sydney Inner West', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 316, 'postcode': '2050', 'suburb': 'Camperdown', 'suburb_seo_key': 'camperdown', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_inner_west', 'region_key_old': None, 'region_name': 'Sydney Inner West', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 326, 'postcode': '2062', 'suburb': 'Cammeray', 'suburb_seo_key': 'cammeray', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_sydney', 'region_key_old': 'Sydney_North', 'region_name': 'North Sydney Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 327, 'postcode': '2063', 'suburb': 'Northbridge', 'suburb_seo_key': 'northbridge', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_sydney', 'region_key_old': 'Sydney_North', 'region_name': 'North Sydney Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 328, 'postcode': '2064', 'suburb': 'Artarmon', 'suburb_seo_key': 'artarmon', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'north_sydney', 'region_key_old': 'Sydney_North', 'region_name': 'North Sydney Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 9.330432, 'matched_on': 'postcode'}, {'id': 213, 'postcode': '2008', 'suburb': 'Chippendale', 'suburb_seo_key': 'chippendale', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'sydney_cbd', 'region_key_old': 'Sydney_City', 'region_name': 'Sydney CBD Region', 'state_id': 2, 'state_name': 'New South Wales', 'state_key': 'nsw', 'score': 8.819606, 'matched_on': 'postcode'}, {'id': 6467, 'postcode': '3496', 'suburb': 'Murray Lock No 9', 'suburb_seo_key': 'murray_lock_no_9', 'popular_suburb': 'N', 'no_backlinks': 0, 'robots_noindex': 0, 'region_key': 'western_district_vic', 'region_key_old': None, 'region_name': 'Western District Region', 'state_id': 7, 'state_name': 'Victoria', 'state_key': 'vic', 'score': 5.296926, 'matched_on': 'suburb'}]


headers = {
    "dnt": "1",
    "if-none-match": 'W/"54e6f-S52/lgP+7jagdfZTWzjiOrt3smU"',
    "priority": "u=0, i",
    "referer": "https://hipages.com.au/directory",
    "sec-ch-ua": '"Google Chrome";v="129", "Not=A?Brand";v="8", "Chromium";v="129"',
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": '"Linux"',
    "sec-fetch-dest": "document",
    "sec-fetch-mode": "navigate",
    "sec-fetch-site": "same-origin",
    "sec-fetch-user": "?1",
    "upgrade-insecure-requests": "1",
    "user-agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36"
}

class HipagesSpider(scrapy.Spider):
    name = "hipages"
    allowed_domains = ["hipages.com.au"]
    start_urls = ["https://hipages.com.au/"]
    search_api = 'https://cerebro.k8s.hipages.com.au/suggest/fuzzimatch?keyword={}&size=5'
    location_api = 'https://cerebro.k8s.hipages.com.au/suggest/location?keyword={}'
    locations = []
    results_api = 'https://gateway.hipages.com.au/directory/v1/businesses?filter%5Bstate%5D=nsw&filter%5Bcategory%5D={}&filter%5Bsuburb%5D={}&page%5Blimit%5D={}&page%5Boffset%5D={}'
    phone_number_api = 'https://gateway.hipages.com.au/directory/v1/phones/{}?fields%5Bphone%5D=formatted%2Ctel'
    
    def parse(self, response):
        keywords = ['Fencer','Fencing','Landscaper','Handymen','Carpenter']
        for keyword in keywords:
            yield Request(
                url=self.search_api.format(keyword.lower()),
                callback=self.parse_suggestions,
                dont_filter=True,
                meta={'keyword': keyword}
            )

    def parse_suggestions(self, response):
        data = response.json()
        directories = list(filter(lambda x: x['title'] == 'Tradies', data))[0]['results']
        for directory in directories:
            for location in LOCATIONS:
                response.meta['dir'] = directory['practice_person_plural'] 
                yield Request(
                    url=self.results_api.format(directory['practice_seo_key'], location['suburb_seo_key'], 10, 0),
                    callback=self.parse_results,
                    dont_filter=True,
                    meta=response.meta
                )

    def parse_results(self, response):
        data = response.json()['data']
        for service in data:
            yield Request(
                url=service['attributes']['profilePageFullUrl'],
                callback=self.parse_details,
                meta=response.meta,
                headers=headers,
                dont_filter=True
            )
    
    def parse_details(self, response):
        data = response.xpath('//script[contains(text(), "__INITIAL_PROPS__")]//text()').get()
        data = data.replace(' window.__INITIAL_PROPS__=', '')
        data = json.loads(json.loads(data))
        data = list(data.values())
        pri_data = data[1]['site'] if 'page' not in list(data[1].keys()) else data[0]['site']
        sec_data = data[1] if 'page' in list(data[1].keys()) else data[0]
        item = Service()
        item['business_name'] = pri_data['name']
        item['abn'] = pri_data['abn']
        item['trade_type'] = response.meta['keyword']
        item['description'] = unescape(remove_tags(sec_data['page']['description']))
        item['email'] = sec_data['page']['email']
        item['category'] = response.meta['dir']
        item['location'] = pri_data['address']
        item['reviews'] = pri_data['rating']['ratings']
        item['rating_avg'] = pri_data['rating']['star_rating']
        item['website'] = response.css('a[data-ga-action="Click tradie website"]::attr(href)').get()
        item['current_url'] = response.url
        yield Request(
            url=self.phone_number_api.format(sec_data['page']['mobile']),
            callback=self.parse_phone,
            meta={'item': item},
        )

    def parse_phone(self, response):
        item = response.meta['item']
        item['phone_number'] = response.json()['data']['attributes']['formatted']
        yield item